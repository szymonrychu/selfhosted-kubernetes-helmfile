tls:
  enabled: true
  autoGenerated: true
  usePem: true

production: true
replicaCount: 3
resources:
  requests:
    memory: 512Mi
    cpu: 50m
  limits:
    memory: 3Gi
    cpu: 750m

proxy: edge

extraEnvVars:
- name: KC_HOSTNAME_URL
  value: https://auth.szymonrichert.pl/
- name: KC_HOSTNAME_ADMIN_URL
  value: https://auth.szymonrichert.pl/
- name: KEYCLOAK_ENABLE_HTTPS
  value: "false"

podLabels:
  application: keycloak

affinity:
  nodeAffinity:
    requiredDuringSchedulingIgnoredDuringExecution:
      nodeSelectorTerms:
      - matchExpressions:
        - key: "kubernetes.io/hostname"
          operator: In
          values:
            - nuc1
            - nuc2
            - nuc3
  podAntiAffinity:
    requiredDuringSchedulingIgnoredDuringExecution:
    - labelSelector:
        matchExpressions:
        - key: application
          operator: In
          values:
          - keycloak
      topologyKey: "kubernetes.io/hostname"

service:
  type: ClusterIP
  sessionAffinity: ClientIP

ingress:
  enabled: true
  ingressClassName: nginx
  hostname: auth.szymonrichert.pl
  annotations:
    cert-manager.io/cluster-issuer: letsencrypt-prod
    kubernetes.io/tls-acme: "true"
    "nginx.ingress.kubernetes.io/proxy-buffer-size": "128k"
  tls: true

pdb:
  create: true

metrics:
  enabled: true
  serviceMonitor:
    enabled: true
    endpoints:
      - path: /metrics
      - path: /realms/master/metrics
      - path: /realms/Lab/metrics
  prometheusRule:
    enabled: true

externalDatabase:
  host: keycloak-postgresql
  port: 5432
  user: keycloak
  database: keycloak
  existingSecret: keycloak.keycloak-postgresql.credentials.postgresql.acid.zalan.do
  existingSecretPasswordKey: password

postgresql:
  enabled: false

cache:
  enabled: true
